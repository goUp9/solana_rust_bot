2026-01-10 08:45:19 | INFO | game_rl_training | Loading tokenizer: Qwen/Qwen3-4B
2026-01-10 08:45:20 | INFO | game_rl_training | Loading base model: Qwen/Qwen3-4B
`torch_dtype` is deprecated! Use `dtype` instead!
2026-01-10 08:45:23 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.26s/it]
2026-01-10 08:45:30 | INFO | game_rl_training | Applying LoRA configuration...
2026-01-10 08:45:30 | WARNING | root | The `device_map` argument is not provided. We will override the device_map argument. to set the entire model on the current device. If you want to set the model on multiple devices, please provide a custom `device_map` argument.
2026-01-10 08:45:31 | INFO | root | peft adapter initialised
2026-01-10 08:45:31 | INFO | game_rl_training | Creating reference model...
2026-01-10 08:45:31 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.25s/it]
2026-01-10 08:45:39 | WARNING | root | A <class 'transformers.models.qwen3.modeling_qwen3.Qwen3ForCausalLM'> model is loaded from 'Qwen/Qwen3-4B', and no v_head weight is found. This IS expected if you are not resuming PPO training.
2026-01-10 08:45:39 | INFO | game_rl_training | Initializing PPO trainer...
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py:262: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
2026-01-10 08:45:39 | INFO | game_rl_training | Using local OpenSpiel execution (in-process inference, no env server, no vLLM).
2026-01-10 08:45:39 | INFO | game_rl_training | Initializing curriculum sampler...
2026-01-10 08:45:39 | INFO | game_rl_training | Setup complete!
2026-01-10 08:45:39 | INFO | game_rl_training | Starting training...
2026-01-10 08:45:39 | INFO | game_rl_training | Step 1/500: Collecting rollouts from 16 episodes...
2026-01-10 09:18:40 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'backgammon': 1, 'clobber': 1, 'leduc_poker': 1}
2026-01-10 09:18:40 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 09:18:41 | INFO | game_rl_training | Step 1 | Reward: 0.6538 | Score: 0.6538 | Success: 66.67% | ValidRate: 0.94%
2026-01-10 09:18:41 | INFO | game_rl_training | Step 2/500: Collecting rollouts from 16 episodes...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
Caching is incompatible with gradient checkpointing in Qwen3DecoderLayer. Setting `past_key_values=None`.
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:1044: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
2026-01-10 09:54:54 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'backgammon': 1, 'leduc_poker': 1, 'clobber': 1}
2026-01-10 09:54:54 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 09:54:55 | INFO | game_rl_training | Step 2 | Reward: 0.6410 | Score: 0.6410 | Success: 66.67% | ValidRate: 0.51%
2026-01-10 09:54:55 | INFO | game_rl_training | Step 3/500: Collecting rollouts from 16 episodes...
2026-01-10 10:29:42 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'hex': 1, 'liars_dice': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 10:29:42 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 10:29:43 | INFO | game_rl_training | Step 3 | Reward: 0.2000 | Score: 0.2000 | Success: 20.00% | ValidRate: 0.24%
2026-01-10 10:29:43 | INFO | game_rl_training | Step 4/500: Collecting rollouts from 16 episodes...
2026-01-10 11:02:45 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'hex': 1, 'liars_dice': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 11:02:45 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 11:02:46 | INFO | game_rl_training | Step 4 | Reward: 0.6000 | Score: 0.6000 | Success: 60.00% | ValidRate: 0.35%
2026-01-10 11:02:46 | INFO | game_rl_training | Step 5/500: Collecting rollouts from 16 episodes...
2026-01-10 11:37:27 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 11:37:27 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 11:37:28 | INFO | game_rl_training | Step 5 | Reward: 0.4000 | Score: 0.4000 | Success: 40.00% | ValidRate: 0.29%
2026-01-10 11:37:28 | INFO | game_rl_training | Step 6/500: Collecting rollouts from 16 episodes...
2026-01-10 12:11:14 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'hex': 1, 'liars_dice': 1, 'othello': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 12:11:14 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 12:11:15 | INFO | game_rl_training | Step 6 | Reward: 0.4000 | Score: 0.4000 | Success: 40.00% | ValidRate: 0.30%
2026-01-10 12:11:15 | INFO | game_rl_training | Step 7/500: Collecting rollouts from 16 episodes...
2026-01-10 12:44:07 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'backgammon': 2, 'liars_dice': 1, 'hex': 1, 'clobber': 1}
2026-01-10 12:44:07 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 12:44:09 | INFO | game_rl_training | Step 7 | Reward: 0.1667 | Score: 0.1667 | Success: 16.67% | ValidRate: 0.41%
2026-01-10 12:44:09 | INFO | game_rl_training | Step 8/500: Collecting rollouts from 16 episodes...
2026-01-10 13:16:26 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 13:16:26 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 13:16:28 | INFO | game_rl_training | Step 8 | Reward: 0.2000 | Score: 0.2000 | Success: 20.00% | ValidRate: 0.73%
2026-01-10 13:16:28 | INFO | game_rl_training | Step 9/500: Collecting rollouts from 16 episodes...
2026-01-10 13:46:41 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'clobber': 1, 'hex': 1, 'backgammon': 1, 'liars_dice': 1}
2026-01-10 13:46:41 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 13:46:43 | INFO | game_rl_training | Step 9 | Reward: 0.6000 | Score: 0.6000 | Success: 60.00% | ValidRate: 0.27%
2026-01-10 13:46:43 | INFO | game_rl_training | Step 10/500: Collecting rollouts from 16 episodes...
2026-01-10 14:29:01 | INFO | game_rl_training | Collected 8 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'clobber': 1, 'backgammon': 3, 'leduc_poker': 1}
2026-01-10 14:29:01 | INFO | game_rl_training | Training with 8 samples...
2026-01-10 14:29:04 | INFO | game_rl_training | Step 10 | Reward: 0.5828 | Score: 0.5865 | Success: 62.50% | ValidRate: 0.54%
2026-01-10 14:29:04 | INFO | game_rl_training | Step 11/500: Collecting rollouts from 16 episodes...
2026-01-10 15:01:13 | INFO | game_rl_training | Collected 8 valid samples from 160 episodes. Games with valid samples: {'hex': 4, 'othello': 1, 'liars_dice': 1, 'backgammon': 1, 'clobber': 1}
2026-01-10 15:01:13 | INFO | game_rl_training | Training with 8 samples...
2026-01-10 15:01:16 | INFO | game_rl_training | Step 11 | Reward: 0.5000 | Score: 0.5000 | Success: 50.00% | ValidRate: 0.40%
2026-01-10 15:01:16 | INFO | game_rl_training | Step 12/500: Collecting rollouts from 16 episodes...
2026-01-10 15:36:32 | INFO | game_rl_training | Collected 12 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'hex': 4, 'othello': 1, 'backgammon': 4, 'clobber': 1, 'leduc_poker': 1}
2026-01-10 15:36:32 | INFO | game_rl_training | Training with 12 samples...
2026-01-10 15:36:37 | INFO | game_rl_training | Step 12 | Reward: 0.5655 | Score: 0.5705 | Success: 58.33% | ValidRate: 0.62%
2026-01-10 15:36:37 | INFO | game_rl_training | Step 13/500: Collecting rollouts from 16 episodes...
2026-01-10 16:28:44 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'leduc_poker': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 16:28:44 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 16:28:45 | INFO | game_rl_training | Step 13 | Reward: 0.3333 | Score: 0.3333 | Success: 16.67% | ValidRate: 0.65%
2026-01-10 16:28:45 | INFO | game_rl_training | Step 14/500: Collecting rollouts from 16 episodes...
2026-01-10 17:10:18 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'leduc_poker': 1, 'hex': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 17:10:19 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 17:10:20 | INFO | game_rl_training | Step 14 | Reward: 0.4167 | Score: 0.4167 | Success: 33.33% | ValidRate: 0.51%
2026-01-10 17:10:20 | INFO | game_rl_training | Step 15/500: Collecting rollouts from 16 episodes...
2026-01-10 17:54:19 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'leduc_poker': 1, 'othello': 1, 'liars_dice': 1, 'hex': 1, 'backgammon': 1, 'clobber': 1}
2026-01-10 17:54:19 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 17:54:20 | INFO | game_rl_training | Step 15 | Reward: 0.5128 | Score: 0.5128 | Success: 50.00% | ValidRate: 0.54%
2026-01-10 17:54:20 | INFO | game_rl_training | Step 16/500: Collecting rollouts from 16 episodes...
2026-01-10 18:28:31 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'hex': 1, 'liars_dice': 1, 'backgammon': 2, 'clobber': 1}
2026-01-10 18:28:31 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 18:28:32 | INFO | game_rl_training | Step 16 | Reward: 0.4983 | Score: 0.5000 | Success: 50.00% | ValidRate: 0.44%
2026-01-10 18:28:32 | INFO | game_rl_training | Step 17/500: Collecting rollouts from 16 episodes...
2026-01-10 19:13:30 | INFO | game_rl_training | Collected 6 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'clobber': 1, 'hex': 1, 'leduc_poker': 1, 'backgammon': 1}
2026-01-10 19:13:30 | INFO | game_rl_training | Training with 6 samples...
2026-01-10 19:13:32 | INFO | game_rl_training | Step 17 | Reward: 0.6154 | Score: 0.6154 | Success: 66.67% | ValidRate: 0.56%
2026-01-10 19:13:32 | INFO | game_rl_training | Step 18/500: Collecting rollouts from 16 episodes...
2026-01-10 19:57:36 | INFO | game_rl_training | Collected 7 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'clobber': 1, 'backgammon': 2, 'leduc_poker': 1}
2026-01-10 19:57:36 | INFO | game_rl_training | Training with 7 samples...
2026-01-10 19:57:38 | INFO | game_rl_training | Step 18 | Reward: 0.5260 | Score: 0.5275 | Success: 57.14% | ValidRate: 0.46%
2026-01-10 19:57:38 | INFO | game_rl_training | Step 19/500: Collecting rollouts from 16 episodes...
2026-01-10 20:28:33 | INFO | game_rl_training | Collected 7 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'hex': 2, 'liars_dice': 1, 'backgammon': 1, 'clobber': 1, 'leduc_poker': 1}
2026-01-10 20:28:33 | INFO | game_rl_training | Training with 7 samples...
2026-01-10 20:28:35 | INFO | game_rl_training | Step 19 | Reward: 0.4986 | Score: 0.5000 | Success: 42.86% | ValidRate: 0.66%
2026-01-10 20:28:35 | INFO | game_rl_training | Step 20/500: Collecting rollouts from 16 episodes...
2026-01-10 21:02:01 | INFO | game_rl_training | Collected 12 valid samples from 160 episodes. Games with valid samples: {'hex': 7, 'othello': 1, 'liars_dice': 1, 'backgammon': 2, 'clobber': 1}
2026-01-10 21:02:01 | INFO | game_rl_training | Training with 12 samples...
2026-01-10 21:02:05 | INFO | game_rl_training | Step 20 | Reward: 0.8153 | Score: 0.8333 | Success: 83.33% | ValidRate: 0.46%
2026-01-10 21:02:05 | INFO | game_rl_training | Step 21/500: Collecting rollouts from 16 episodes...
2026-01-10 21:34:51 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 1, 'backgammon': 1, 'clobber': 1}
2026-01-10 21:34:51 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 21:34:52 | INFO | game_rl_training | Step 21 | Reward: 0.2000 | Score: 0.2000 | Success: 20.00% | ValidRate: 0.25%
2026-01-10 21:34:52 | INFO | game_rl_training | Step 22/500: Collecting rollouts from 16 episodes...
2026-01-10 22:04:50 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'backgammon': 1, 'liars_dice': 1, 'hex': 1, 'clobber': 1}
2026-01-10 22:04:50 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 22:04:52 | INFO | game_rl_training | Step 22 | Reward: 1.0000 | Score: 1.0000 | Success: 100.00% | ValidRate: 0.29%
2026-01-10 22:04:52 | INFO | game_rl_training | Step 23/500: Collecting rollouts from 16 episodes...
2026-01-10 22:41:57 | INFO | game_rl_training | Collected 12 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'backgammon': 3, 'hex': 5, 'clobber': 1, 'leduc_poker': 1}
2026-01-10 22:41:57 | INFO | game_rl_training | Training with 12 samples...
2026-01-10 22:42:01 | INFO | game_rl_training | Step 23 | Reward: 0.5494 | Score: 0.5577 | Success: 58.33% | ValidRate: 0.63%
2026-01-10 22:42:01 | INFO | game_rl_training | Step 24/500: Collecting rollouts from 16 episodes...
2026-01-10 23:14:55 | INFO | game_rl_training | Collected 5 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'hex': 1, 'othello': 1, 'clobber': 1, 'backgammon': 1}
2026-01-10 23:14:55 | INFO | game_rl_training | Training with 5 samples...
2026-01-10 23:14:57 | INFO | game_rl_training | Step 24 | Reward: 0.8000 | Score: 0.8000 | Success: 80.00% | ValidRate: 0.31%
2026-01-10 23:14:57 | INFO | game_rl_training | Step 25/500: Collecting rollouts from 16 episodes...
2026-01-10 23:48:55 | INFO | game_rl_training | Collected 11 valid samples from 160 episodes. Games with valid samples: {'liars_dice': 1, 'othello': 1, 'hex': 5, 'backgammon': 3, 'clobber': 1}
2026-01-10 23:48:55 | INFO | game_rl_training | Training with 11 samples...
2026-01-10 23:48:58 | INFO | game_rl_training | Step 25 | Reward: 0.1364 | Score: 0.1364 | Success: 9.09% | ValidRate: 0.38%
2026-01-10 23:48:58 | INFO | game_rl_training | Step 26/500: Collecting rollouts from 16 episodes...
2026-01-11 00:30:20 | INFO | game_rl_training | Collected 10 valid samples from 160 episodes. Games with valid samples: {'othello': 1, 'hex': 5, 'liars_dice': 1, 'clobber': 1, 'backgammon': 1, 'leduc_poker': 1}
2026-01-11 00:30:20 | INFO | game_rl_training | Training with 10 samples...
2026-01-11 00:30:23 | INFO | game_rl_training | Step 26 | Reward: 0.3846 | Score: 0.3846 | Success: 40.00% | ValidRate: 0.75%
2026-01-11 00:30:23 | INFO | game_rl_training | Step 27/500: Collecting rollouts from 16 episodes...
