2026-01-09 19:59:09 | INFO | game_rl_training | Loading tokenizer: Qwen/Qwen3-4B
2026-01-09 19:59:10 | INFO | game_rl_training | Loading base model: Qwen/Qwen3-4B
`torch_dtype` is deprecated! Use `dtype` instead!
2026-01-09 19:59:12 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.27s/it]
2026-01-09 19:59:19 | INFO | game_rl_training | Applying LoRA configuration...
2026-01-09 19:59:19 | WARNING | root | The `device_map` argument is not provided. We will override the device_map argument. to set the entire model on the current device. If you want to set the model on multiple devices, please provide a custom `device_map` argument.
2026-01-09 19:59:20 | INFO | root | peft adapter initialised
2026-01-09 19:59:20 | INFO | game_rl_training | Creating reference model...
2026-01-09 19:59:20 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.24s/it]
2026-01-09 19:59:28 | WARNING | root | A <class 'transformers.models.qwen3.modeling_qwen3.Qwen3ForCausalLM'> model is loaded from 'Qwen/Qwen3-4B', and no v_head weight is found. This IS expected if you are not resuming PPO training.
2026-01-09 19:59:28 | INFO | game_rl_training | Initializing PPO trainer...
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py:262: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
2026-01-09 19:59:29 | INFO | game_rl_training | Using local OpenSpiel execution (in-process inference, no env server, no vLLM).
2026-01-09 19:59:29 | INFO | game_rl_training | Initializing curriculum sampler...
2026-01-09 19:59:29 | INFO | game_rl_training | Setup complete!
2026-01-09 19:59:29 | INFO | game_rl_training | Starting training...
2026-01-09 19:59:29 | INFO | game_rl_training | Step 1/500: Collecting rollouts...
2026-01-09 20:07:14 | INFO | game_rl_training | Training with 9 samples...
2026-01-09 20:07:19 | INFO | game_rl_training | Step 2/500: Collecting rollouts...
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
Caching is incompatible with gradient checkpointing in Qwen3DecoderLayer. Setting `past_key_values=None`.
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:1044: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
2026-01-09 20:13:46 | WARNING | game_rl_training | Step 2: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 20:13:46 | INFO | game_rl_training | Step 3/500: Collecting rollouts...
2026-01-09 20:18:23 | WARNING | game_rl_training | Step 3: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 20:18:23 | INFO | game_rl_training | Step 4/500: Collecting rollouts...
2026-01-09 20:26:08 | WARNING | game_rl_training | Step 4: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 20:26:08 | INFO | game_rl_training | Step 5/500: Collecting rollouts...
2026-01-09 20:30:14 | WARNING | game_rl_training | Step 5: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 20:30:14 | INFO | game_rl_training | Step 6/500: Collecting rollouts...
2026-01-09 20:37:06 | WARNING | game_rl_training | Step 6: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 20:37:06 | INFO | game_rl_training | Step 7/500: Collecting rollouts...
2026-01-09 20:41:51 | WARNING | game_rl_training | Step 7: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 20:41:51 | INFO | game_rl_training | Step 8/500: Collecting rollouts...
2026-01-09 20:46:10 | WARNING | game_rl_training | Step 8: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 20:46:10 | INFO | game_rl_training | Step 9/500: Collecting rollouts...
2026-01-09 20:56:13 | WARNING | game_rl_training | Step 9: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 20:56:13 | INFO | game_rl_training | Step 10/500: Collecting rollouts...
2026-01-09 21:04:38 | WARNING | game_rl_training | Step 10: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 21:04:38 | INFO | game_rl_training | Step 11/500: Collecting rollouts...
2026-01-09 21:10:59 | WARNING | game_rl_training | Step 11: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 21:10:59 | INFO | game_rl_training | Step 12/500: Collecting rollouts...
2026-01-09 21:21:31 | WARNING | game_rl_training | Step 12: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 21:21:31 | INFO | game_rl_training | Step 13/500: Collecting rollouts...
2026-01-09 21:24:59 | WARNING | game_rl_training | Step 13: Only 1 valid samples collected (need 8). Skipping training step.
2026-01-09 21:24:59 | INFO | game_rl_training | Step 14/500: Collecting rollouts...
2026-01-09 21:35:10 | WARNING | game_rl_training | Step 14: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 21:35:10 | INFO | game_rl_training | Step 15/500: Collecting rollouts...
2026-01-09 21:36:57 | WARNING | game_rl_training | Step 15: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 21:36:57 | INFO | game_rl_training | Step 16/500: Collecting rollouts...
2026-01-09 21:42:16 | WARNING | game_rl_training | Step 16: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 21:42:16 | INFO | game_rl_training | Step 17/500: Collecting rollouts...
2026-01-09 21:45:44 | WARNING | game_rl_training | Step 17: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 21:45:44 | INFO | game_rl_training | Step 18/500: Collecting rollouts...
2026-01-09 21:52:53 | WARNING | game_rl_training | Step 18: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 21:52:53 | INFO | game_rl_training | Step 19/500: Collecting rollouts...
2026-01-09 21:56:18 | WARNING | game_rl_training | Step 19: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 21:56:18 | INFO | game_rl_training | Step 20/500: Collecting rollouts...
2026-01-09 21:57:55 | WARNING | game_rl_training | Step 20: Only 2 valid samples collected (need 8). Skipping training step.
2026-01-09 21:57:55 | INFO | game_rl_training | Step 21/500: Collecting rollouts...
2026-01-09 22:09:27 | WARNING | game_rl_training | Step 21: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 22:09:27 | INFO | game_rl_training | Step 22/500: Collecting rollouts...
2026-01-09 22:11:24 | WARNING | game_rl_training | Step 22: Only 0 valid samples collected (need 8). Skipping training step.
2026-01-09 22:11:24 | INFO | game_rl_training | Step 23/500: Collecting rollouts...
2026-01-09 22:20:48 | WARNING | game_rl_training | Step 23: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 22:20:48 | INFO | game_rl_training | Step 24/500: Collecting rollouts...
2026-01-09 22:27:01 | WARNING | game_rl_training | Step 24: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 22:27:01 | INFO | game_rl_training | Step 25/500: Collecting rollouts...
2026-01-09 22:33:32 | WARNING | game_rl_training | Step 25: Only 1 valid samples collected (need 8). Skipping training step.
2026-01-09 22:33:32 | INFO | game_rl_training | Step 26/500: Collecting rollouts...
2026-01-09 22:39:33 | WARNING | game_rl_training | Step 26: Only 5 valid samples collected (need 8). Skipping training step.
2026-01-09 22:39:33 | INFO | game_rl_training | Step 27/500: Collecting rollouts...
2026-01-09 22:50:02 | WARNING | game_rl_training | Step 27: Only 5 valid samples collected (need 8). Skipping training step.
2026-01-09 22:50:02 | INFO | game_rl_training | Step 28/500: Collecting rollouts...
2026-01-09 22:55:29 | WARNING | game_rl_training | Step 28: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 22:55:29 | INFO | game_rl_training | Step 29/500: Collecting rollouts...
2026-01-09 23:03:53 | WARNING | game_rl_training | Step 29: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 23:03:53 | INFO | game_rl_training | Step 30/500: Collecting rollouts...
2026-01-09 23:11:05 | WARNING | game_rl_training | Step 30: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 23:11:05 | INFO | game_rl_training | Step 31/500: Collecting rollouts...
2026-01-09 23:17:33 | WARNING | game_rl_training | Step 31: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 23:17:33 | INFO | game_rl_training | Step 32/500: Collecting rollouts...
2026-01-09 23:26:21 | WARNING | game_rl_training | Step 32: Only 4 valid samples collected (need 8). Skipping training step.
2026-01-09 23:26:21 | INFO | game_rl_training | Step 33/500: Collecting rollouts...
2026-01-09 23:29:26 | WARNING | game_rl_training | Step 33: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 23:29:26 | INFO | game_rl_training | Step 34/500: Collecting rollouts...
2026-01-09 23:35:18 | WARNING | game_rl_training | Step 34: Only 3 valid samples collected (need 8). Skipping training step.
2026-01-09 23:35:18 | INFO | game_rl_training | Step 35/500: Collecting rollouts...
