2026-01-12 01:44:43 | INFO | game_rl_training | Loading tokenizer: Qwen/Qwen3-4B
2026-01-12 01:44:44 | INFO | game_rl_training | Loading base model: Qwen/Qwen3-4B
`torch_dtype` is deprecated! Use `dtype` instead!
2026-01-12 01:44:46 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.32s/it]
2026-01-12 01:44:54 | INFO | game_rl_training | Applying LoRA configuration...
2026-01-12 01:44:54 | WARNING | root | The `device_map` argument is not provided. We will override the device_map argument. to set the entire model on the current device. If you want to set the model on multiple devices, please provide a custom `device_map` argument.
2026-01-12 01:44:54 | INFO | root | peft adapter initialised
2026-01-12 01:44:54 | INFO | game_rl_training | Creating reference model...
2026-01-12 01:44:55 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.32s/it]
2026-01-12 01:45:03 | WARNING | root | A <class 'transformers.models.qwen3.modeling_qwen3.Qwen3ForCausalLM'> model is loaded from 'Qwen/Qwen3-4B', and no v_head weight is found. This IS expected if you are not resuming PPO training.
2026-01-12 01:45:03 | INFO | game_rl_training | Initializing PPO trainer...
wandb: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
/root/workplace/game_rl_training/venv/lib/python3.12/site-packages/trl/trainer/ppo_trainer.py:262: UserWarning: No dataset is provided. Make sure to set config.batch_size to the correct value before training.
  warnings.warn(
2026-01-12 01:45:03 | INFO | game_rl_training | Using local OpenSpiel execution (in-process inference, no env server, no vLLM).
2026-01-12 01:45:03 | INFO | game_rl_training | Initializing curriculum sampler...
2026-01-12 01:45:03 | INFO | game_rl_training | Setup complete!
2026-01-12 01:45:03 | INFO | game_rl_training | Starting training...
2026-01-12 01:45:03 | INFO | game_rl_training | Step 1/100: Collecting rollouts from 64 episodes...
2026-01-12 01:45:34 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:45:34 | WARNING | game_rl_training | Step 1: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:45:34 | INFO | game_rl_training | Step 2/100: Collecting rollouts from 64 episodes...
2026-01-12 01:45:54 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:45:54 | WARNING | game_rl_training | Step 2: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:45:54 | INFO | game_rl_training | Step 3/100: Collecting rollouts from 64 episodes...
2026-01-12 01:46:37 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:46:37 | WARNING | game_rl_training | Step 3: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:46:37 | INFO | game_rl_training | Step 4/100: Collecting rollouts from 64 episodes...
2026-01-12 01:47:49 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:47:49 | WARNING | game_rl_training | Step 4: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:47:49 | INFO | game_rl_training | Step 5/100: Collecting rollouts from 64 episodes...
2026-01-12 01:48:29 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:48:29 | WARNING | game_rl_training | Step 5: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:48:29 | INFO | game_rl_training | Step 6/100: Collecting rollouts from 64 episodes...
2026-01-12 01:49:22 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:49:22 | WARNING | game_rl_training | Step 6: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:49:22 | INFO | game_rl_training | Step 7/100: Collecting rollouts from 64 episodes...
2026-01-12 01:49:36 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:49:36 | WARNING | game_rl_training | Step 7: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:49:36 | INFO | game_rl_training | Step 8/100: Collecting rollouts from 64 episodes...
2026-01-12 01:50:19 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:50:19 | WARNING | game_rl_training | Step 8: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:50:19 | INFO | game_rl_training | Step 9/100: Collecting rollouts from 64 episodes...
2026-01-12 01:51:14 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:51:14 | WARNING | game_rl_training | Step 9: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:51:14 | INFO | game_rl_training | Step 10/100: Collecting rollouts from 64 episodes...
2026-01-12 01:51:33 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:51:33 | WARNING | game_rl_training | Step 10: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:51:33 | INFO | game_rl_training | Step 11/100: Collecting rollouts from 64 episodes...
2026-01-12 01:51:45 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:51:45 | WARNING | game_rl_training | Step 11: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:51:45 | INFO | game_rl_training | Step 12/100: Collecting rollouts from 64 episodes...
2026-01-12 01:51:56 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'leduc_poker': 1, 'liars_dice': 1}
2026-01-12 01:51:56 | WARNING | game_rl_training | Step 12: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:51:56 | INFO | game_rl_training | Step 13/100: Collecting rollouts from 64 episodes...
2026-01-12 01:52:11 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:52:11 | WARNING | game_rl_training | Step 13: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:52:11 | INFO | game_rl_training | Step 14/100: Collecting rollouts from 64 episodes...
2026-01-12 01:52:32 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'leduc_poker': 1, 'liars_dice': 1}
2026-01-12 01:52:32 | WARNING | game_rl_training | Step 14: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:52:32 | INFO | game_rl_training | Step 15/100: Collecting rollouts from 64 episodes...
2026-01-12 01:53:43 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:53:43 | WARNING | game_rl_training | Step 15: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:53:43 | INFO | game_rl_training | Step 16/100: Collecting rollouts from 64 episodes...
2026-01-12 01:54:26 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:54:26 | WARNING | game_rl_training | Step 16: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:54:26 | INFO | game_rl_training | Step 17/100: Collecting rollouts from 64 episodes...
2026-01-12 01:54:41 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:54:41 | WARNING | game_rl_training | Step 17: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:54:41 | INFO | game_rl_training | Step 18/100: Collecting rollouts from 64 episodes...
2026-01-12 01:54:56 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'leduc_poker': 1, 'liars_dice': 1}
2026-01-12 01:54:56 | WARNING | game_rl_training | Step 18: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:54:56 | INFO | game_rl_training | Step 19/100: Collecting rollouts from 64 episodes...
2026-01-12 01:55:09 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:55:09 | WARNING | game_rl_training | Step 19: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:55:09 | INFO | game_rl_training | Step 20/100: Collecting rollouts from 64 episodes...
2026-01-12 01:55:39 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:55:39 | WARNING | game_rl_training | Step 20: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:55:39 | INFO | game_rl_training | Step 21/100: Collecting rollouts from 64 episodes...
2026-01-12 01:55:58 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:55:58 | WARNING | game_rl_training | Step 21: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:55:58 | INFO | game_rl_training | Step 22/100: Collecting rollouts from 64 episodes...
2026-01-12 01:56:42 | INFO | game_rl_training | Collected 2 valid samples from 640 episodes. Games with valid samples: {'liars_dice': 1, 'leduc_poker': 1}
2026-01-12 01:56:42 | WARNING | game_rl_training | Step 22: Only 2 valid samples collected (need 16). Skipping training step.
2026-01-12 01:56:42 | INFO | game_rl_training | Step 23/100: Collecting rollouts from 64 episodes...
